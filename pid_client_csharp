using System;
using System.Web;
using Microsoft.AspNet.SignalR;
namespace SignalRChat
{
    public class ArduinoHub : Hub
    {
        public void Send(string sensor_val)
        {
            double adj_control = 0;
            double reference = 600;
            double sensor_value = Convert.ToDouble(sensor_val);
            double error = reference - sensor_value;
            double control = ((error * 1) / 850) * 255;
            adj_control += control;
            if (adj_control < 0) adj_control = 0;
            if (adj_control > 255) adj_control = 255;


            // Call the broadcastMessage method to update clients.
            Clients.All.broadcastMessage(sensor_val, adj_control);
        }
    }
}
